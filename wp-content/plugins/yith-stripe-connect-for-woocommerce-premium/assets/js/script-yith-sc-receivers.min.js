jQuery(function(i){function e(e){e.preventDefault(),i("#yith_wcsc_receivers_panel").block({message:null,overlayCSS:{background:"#fff",opacity:.6}});e={action:"print_receiver_row_action",index:i(".yith_wcsc_receiver_row").length};yith_wcsc_receivers.context!==undefined&yith_wcsc_receivers.product_id!==undefined&&(e.context=yith_wcsc_receivers.context,e.product_id=yith_wcsc_receivers.product_id),i.post(ajaxurl,e).success(function(e){i("#yith_wcsc_receivers_panel").find("table").find("tbody").append(e),i(".wc-customer-search, .wc-product-search").trigger("wc-enhanced-select-init"),i("#yith_wcsc_receivers_panel").unblock()})}function _(){i("._receiver_order").each(function(e){i(this).val(e),i(this).trigger("change")})}i(".add_receiver_button").click(e),i("#yith_wcsc_receivers_panel").on("click",".remove_receiver",function(e){e.preventDefault();var e=i("#_data_to_remove"),c=i(this).closest(".yith_wcsc_receiver_row"),t=c.attr("id"),r=i("#_receivers_"+t+"_ID").val(),r=("new"!=r&&(e.val().split(",").indexOf(r)<0&&(0==e.val().length?e.val(r):e.val(e.val()+","+r)),e.val(e.val().replace(",,",","))),new RegExp(t+",?"));i("#_data_to_save").val(i("#_data_to_save").val().replace(r,"")),c.remove(),_()}),i(".yith_wcsc_table_receivers").sortable({stop:function(e,c){_()}}),i("#yith_wcsc_receivers_panel").on("click","._receiver_all_products_button",function(e){e.preventDefault();e=i(this).next("._receiver_all_products");1==e.val()?(e.attr("value","0"),i(this).removeClass("yith_wcsc_enabled")):(e.attr("value","1"),i(this).addClass("yith_wcsc_enabled")),e.trigger("change")}),i(".save_receivers").click(function(e){e.preventDefault();e="action=save_receivers_action&_receivers_to_save="+i("#_data_to_save").val().split(",")+"&_receivers_to_remove="+i("#_data_to_remove").val().split(",")+"&"+i("._receiver").serialize();i("#yith_wcsc_receivers_panel").block({message:null,overlayCSS:{background:"#fff",opacity:.6}}),i.post(ajaxurl,e).success(function(e){i("#_data_to_save").val(""),i("#_data_to_remove").val("");for(var c=0;c<e.length;c++){var t=i("#_receivers_"+e[c].index+"_stripe_id");i("#_receivers_"+e[c].index+"_receiver_ID").val(e[c].id_receiver),t.val(e[c].stripe_id),"connect"===e[c].status_receiver&&(t.css("border","1px solid green"),t.css("color","black"),t.parent().next().find("._commission").attr("src",yith_wcsc_receivers.assets_url+"images/sc-icon-"+e[c].status_receiver+".svg"),t.parent().next().find("._commission").attr("title","Connected"))}i("#yith_wcsc_receivers_panel").unblock()})}),i("#yith_wcsc_receivers_panel").on("change","._receiver_all_products",function(){var e=i(this).closest(".option-product");1==i(this).val()?(e.find(".select2-selection__clear").trigger("mousedown"),e.find(".select2-selection__placeholder").text("All Products"),e.find("select").prop("disabled",!0)):(e.find("select").prop("disabled",!1),e.find(".select2-selection__placeholder").text("Search products"))}),i("._receiver_all_products").trigger("change"),i("#yith_wcsc_receivers_panel").on("change","._receiver",function(){var e=i("#_data_to_save"),c=i(this).closest(".yith_wcsc_receiver_row").attr("id");e.val().split(",").indexOf(c)<0&&(0==e.val().length?e.val(c):e.val(e.val()+","+c)),i("#_data_to_save").val(i("#_data_to_save").val().replace(",,",","))})});